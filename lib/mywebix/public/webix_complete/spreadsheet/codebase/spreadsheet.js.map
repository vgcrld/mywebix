{"version":3,"file":"spreadsheet.js","sources":["../sources/views/button.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/image.js","../sources/math/parser.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/lock_cell.js","../sources/operations/undo.js","../sources/operations/spans.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/filter.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-value\": \"Value\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"graph\": \"Graph\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"create-filter\": \"Create filter\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\"\n\t}\n};","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t}\n},webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tif(value){\n\t\t\tcolorboard.setValue(value);\n\t\t\tthis.config.value = value;\n\t\t\tthis.getColorNode().style.backgroundColor = value;\n\t\t}\n\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t},\n\tgetHeaderConfig: function(label){\n\t\treturn {\n\t\t\tpaddingX: 10,\n\t\t\tpaddingY: 5,\n\t\t\theight: 60,\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: label},\n\t\t\t\t{ view: \"icon\", css:\"webix_ssheet_hide_icon\", icon:\"webix_ssheet_icon ssi-close\", width: 50, click: function(){\n\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\tparentView.callEvent(\"onHideClick\",[]);\n\t\t\t\t}}\n\t\t\t]\n\t\t};\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpaddingY: 0,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\telements.push({height:10, borderless: true});\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tvalue.paddingY = value.paddingY||0;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\thead_setter:function(value){\n\t\tif(value){\n\t\t\tvalue = this.getHeaderConfig(value);\n\t\t}\n\t\treturn webix.ui.window.prototype.head_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tpadding:0,\n\t\tmove:true,\n\t\thead: true,\n\t\tbuttons: true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_table webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst trg = webix.$$(this.config.master).getInputNode();\n\t\t\tconst cursor = trg.selectionStart;\n\t\t\tconst val = trg.value;\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0)){\n\t\t\t\tvalue = str1[0];\n\t\t\t}\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\t//only for formulas\n\t\t\t\tif(!node.value || node.value.charAt(0) !== \"=\") return false;\n\t\t\t\t\n\t\t\t\tconst sizes = webix.html.offset(node);\n\t\t\t\tconst symbolLength = 9;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + (node.selectionStart * symbolLength);\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\tlet master = webix.$$(this.config.master);\n\t\tmaster.setValueHere(text);\n\t\t\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function(popup) {\n\t\tif (popup.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);\n","import \"./suggest_formula\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName: \"text webix_ssheet_formula\",\n\tdefaults:{\n\t\tkeyPressTimeout: 25\n\t},\n\t$init(config) {\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tthis.attachEvent(\"onKeyPress\", (code) => {\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(function(){ this.getTopParentView()._table.moveSelection(\"down\"); },this);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", webix.once(function(){\n\t\t\tvar node = this.getInputNode();\n\t\t\tvar ev =  webix.env.isIE8?\"propertychange\":\"input\";\n\n\t\t\twebix.event(node, ev, webix.bind(this.paintValue, this));\n\t\t\twebix.event(node, \"keydown\", webix.bind(this.endEdit, this));\n\t\t}));\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\t\tlet node = this.getInputNode();\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && node.value.charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue (){\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\t\tlet node = master._table.getItemNode(cell);\n\n\t\tif(cell && node) \n\t\t\tnode.innerHTML = this.getValue();\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse {\n\t\t\tif (newv != master.getCellValue(cell.row, cell.column)){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tlet node = this.getInputNode();\n\t\tif(node.value && node.value.charAt(0)===\"=\"){\n\t\t\tconst formula = node.value;\n\t\t\tconst cursor = node.selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\t\t\tstr1 = str1.replace(/([a-zA-Z(]+)$/, value);\n\n\t\t\tnode.value = str1 + \"(\" + str2;\n\t\t\tnode.setSelectionRange(str1.length + 1, str1.length + 1);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn text.substr(0, 1) == \"=\" && last.match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range) {\n\t\tlet node = this.getInputNode();\n\t\tconst cursor = node.selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1 = formula.substring(0, cursor) + range;\n\t\tlet str2 = formula.substring(cursor);\n\n\t\tnode.value = str1 + str2;\n\t\tnode.setSelectionRange(str1.length + 1, str1.length + 1);\n\t\tthis.focus();\n\t}\n}, webix.ui.text);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t\tthis.setValue(config.value);\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tthis.blockEvent();\n\t\t\tif(this.$eventSource.config.name ===\"$all\"){\n\t\t\t\tfor(var i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tthis.getChildViews()[0].getBody().getChildViews()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar count = this.getValue().length;\n\t\t\t\tif(count === this._count)\n\t\t\t\t\tthis.elements.$all.setValue(1);\n\t\t\t\tif(count < this._count)\n\t\t\t\t\tthis.elements.$all.setValue(0);\n\t\t\t\tif(count ===0)\n\t\t\t\t\tthis.elements[this._findNext(this.$eventSource.config.name)].setValue(1);\n\t\t\t}\t\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\t_findNext:function(name){\n\t\tfor(var i in this.elements)\n\t\t\tif(i !==name && i !==\"$all\")\n\t\t\t\treturn i;\n\t},\n\tsetValue:function(value){\n\t\tvar keys = [];\n\t\tfor(let i in value) keys.push(i);\n\n\t\tvalue = value || {};\n\t\tthis.elements = {};\n\t\tthis._count = keys.length;\n\n\t\tif(typeof value !==\"object\" || !keys.length){\n\t\t\tif(this.getChildViews().length >1)\n\t\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t\telse{\n\t\t\tvar elements = [], base = [], maxHeight = 400;\n\t\t\tfor(let i in value) \n\t\t\t\tbase.push({ view:\"checkbox\", labelRight:i, name:i});\n\t\t\tvar baseHeight = base.length*webix.skin.$active.inputHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll:baseHeight>maxHeight,\n\t\t\t\theight:(baseHeight>maxHeight?maxHeight:baseHeight)\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10});\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\"});\n\n\t\t\twebix.ui(elements, this);\n\t\t\tfor(let i in value)\n\t\t\t\tif(value[i]) this.elements[i].setValue(value[i]);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tvar value = this.getValues(), output = [];\n\t\tfor(var i in value)\n\t\t\tif(value[i] && i !==\"$all\") output.push(i);\n\t\treturn output;\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif(start.row <= r1)\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif(start.column <= c1)\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"top\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"vertical-align\": {\n\t\t\"top\": function(){\n\t\t\treturn \"display: block;\";\n\t\t},\n\t\t\"middle\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items: center;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t},\n\t\t\"bottom\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items:flex-end;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t}\n\t},\n\t\"wrap\": {\n\t\t\"wrap\": function(){\n\t\t\tvar padding = 7 - (34-webix.skin.$active.rowHeight);\n\t\t\treturn \"white-space: normal !important; line-height:normal !important; padding-top:\"+padding+\"px;padding-bottom:\"+padding+\"px;\";\n\t\t},\n\t\t\"nowrap\": function(){\n\t\t\treturn \"\";\n\t\t}\n\t},\n\t\"format\":\"\",\n\t\"borders\": \"\",\n\t\"border-left\":function(obj){\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":function(obj){\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\":function(obj){\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": function(obj){\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": function(obj){\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view.getRow(row), column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(item, column, style){\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, x, y){\n\tlet width = 0;\n\tlet height = 0;\n\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = (x||1)+\"px\";\n\tsizeEl.style.height = (y||1)+\"px\";\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\twidth = Math.max(width, sizeEl.scrollWidth);\n\theight = Math.max(height, sizeEl.scrollHeight);\n\t\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width: width, height: height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\tupdate_style_data(view.getRow(cell.row), cell.column, style);\n\t\tview.saveCell(cell.row,cell.column);\n\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\t}\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport group from \"./undo_group\";\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n\t\n}\n\nexport function serialize(view, data){\n\tvar formats = [];\n\n\tfor(let i in formatSources){\n\t\tif(i!=\"percent\" && i!=\"int\" && i!=\"price\") //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tgetFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parced = parceFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parced, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction getFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tvar old = view.getStyle(row, column);\n\tvar fmtstring = getFormatName(format, type);\n\tvar nev = addStyle(view, { format: fmtstring }, old);\n\tview.setStyle(row, column, nev);\n}\n\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", code.join(\"\\n\")+\" return val;\");\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\tif (line.indexOf(\"%\") !== -1)\n\t\tstr += \"val = val*100;\";\n\tstr += genFormatCode(line, delimiters);\n\treturn str+(check?\"}\":\"\");\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line) return \"return val;\";\n\tvar isQuote = 0;\n\tvar str = \"return \\\"\\\"\";\n\tvar fmt = \"\";\n\tvar comma = false;\n\tvar inserted = false;\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif (isQuote){\n\t\t\t\tstr += `+\"${line.substr(isQuote, i-isQuote)}\"`;\n\t\t\t\tisQuote = false;\n\t\t\t\tcontinue;\n\t\t\t} else \n\t\t\t\tisQuote = i;\n\t\t}\n\t\tif (isQuote) continue;\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t} else if (placeholder(line[i])){\n\t\t\tif (!inserted) { str+=\"+fmt\"; inserted=true; }\n\t\t\tfmt+=line[i];\n\t\t} else if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif (fmt)\n\t\treturn numberFormat(fmt, comma, delimiters)+\";\"+str + \";\";\n\telse\n\t\treturn str+\";\";\n}\n\nfunction numberFormat(fmt, comma, delimiters){\n\tvar str = \"if (isNaN(val)) var fmt = val; else {\";\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\t\t\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parced = parceFormat(fmt);\n\tfor(let i = 0; i < parced.length; i++){\n\t\tif(parced[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparced[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparced[i].right.placeholders = parced[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parced[i].left.text && !parced[i].right.text;\n\t\t\tconst withoutPlaceholders = !parced[i].left.placeholders && !parced[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparced[i].left.placeholders = \"0\";\n\t\t\t\tparced[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parced[i].left.placeholders || withoutText)){\n\t\t\t\tparced[i].left.placeholders = parced[i].left.placeholders || \"0\";\n\t\t\t\tparced[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparced[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparced[i].decimals = parced[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parced);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tconst name = view.getStyle(cells[0].row, cells[0].column).props.format;\n\t\tview.$$(\"bar\").setValues({format:name.indexOf(\"fmt\") < 0 ? name : \"custom\"}, true);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text  = \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\t\tif(values[i].left.text){\n\t\t\tconst leftText = values[i].left.text;\n\t\t\tfmt += toExcel ? \"\\\"\"+leftText+\"\\\"\" : leftText;\n\t\t}\n\t\tif(values[i].left.placeholders){\n\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t}\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\t\tif(values[i].right.placeholders)\n\t\t\tfmt += values[i].right.placeholders;\n\t\tif(values[i].right.text){\n\t\t\tlet rightText = values[i].right.text;\n\n\t\t\tif(toExcel)\n\t\t\t\trightText = (\"\\\"\"+rightText+\"\\\"\").replace(/%/g, \"\\\"%\\\"\").replace(/\"\"/g, \"\");\n\n\t\t\tfmt += rightText;\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parceFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"],\n\t\t\t\t\t\tcallback:function(res){\n\t\t\t\t\t\t\tif(res) view.combineCells();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn   {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", type:\"htmlbutton\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue: \"wrap\",offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"add-image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"add-sparkline\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tvar styles = {};\n\tvar cell = selected[0];\n\tif(cell){\n\t\tvar obj = view.getStyle(cell.row, cell.column);\n\t\tif (obj)\n\t\t\tstyles = obj.props;\n\t}\n\n\tvar barStyles = webix.copy(styles);\n\n\tfor(var i in defaultStyles){\n\t\tif(!barStyles[i])\n\t\t\tbarStyles[i] = defaultStyles[i];\n\t}\n\n\tbarStyles.format = isCustom(barStyles.format) ? \"custom\" : barStyles.format;\n\n\tview.$$(\"bar\").setValues(barStyles);\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\t\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\t\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\n\tview._table.eachRow(function(row) {\n\t\tconst rowobj = this.getItem(row);\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, 0, rowobj.$height);\n\t\t\tif (size.width > width) width = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\t\n\tview._table.eachColumn(function(column) {\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, this.getColumnConfig(column).width, 0);\n\t\t\tif (size.height > height) height = size.height;\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\t\n\tvar sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row >=sr && row<=er)\n\t\t\tview._table.addCellCss(row, \"rowId\", \"webix_highlight\");\n\t\telse \n\t\t\tview._table.removeCellCss(row, \"rowId\", \"webix_highlight\");\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tvar node = view._table.getHeaderNode(col);\n\t\tif(!node) return;\n\n\t\tif(col >=sc && col<=ec)\n\t\t\twebix.html.addCss(node, \"webix_highlight\");\n\t\telse\n\t\t\twebix.html.removeCss(node, \"webix_highlight\");\n\t});\n}\n\n\n\n\n\n\n","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminColumnWidth:1,\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\tview.attachEvent(\"onDestruct\", () => webix.eventRemove(showHandler));\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\t\n\t//column drag event checking\n\tlet dragStartColumn;\n\tgrid.$view.firstChild.addEventListener(\"mousedown\", (e)=>{\n\t\t//column ids are starting from 0, thats why we adding 1\n\t\tdragStartColumn = e.target.parentNode.cellIndex + 1;\n\t});\n\tgrid.$view.firstChild.addEventListener(\"mouseup\", (e)=>{\n\t\tconst dragEndColumn = e.target.parentNode.cellIndex + 1;\n\t\tif (dragStartColumn && dragStartColumn !== dragEndColumn) {\n\t\t\tcop.selectColumn(dragStartColumn, view, dragEndColumn);\n\t\t\tdragStartColumn = undefined;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\tgrid.attachEvent(\"onSelectChange\", () => {\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t} else {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\t\t\t\t\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n}\n\nfunction cell_template(view, obj, common, value, column){\n\tvar format = obj.$cellFormat ? obj.$cellFormat[column.id] : null;\n\n\tvar commented = view.comments.get(obj.id, column.id) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\n\tif (format){\n\t\tvar cell = { css:\"\" };\n\t\tvar helper = fmt.getFormat(format);\n\t\tif (helper){\n\t\t\tlet parsed = parseFloat(value);\n\t\t\tif (!isNaN(parsed)){\n\t\t\t\tvar newvalue = helper(parsed, cell);\n\t\t\t\tif (cell.css)\n\t\t\t\t\treturn \"<div class='\"+cell.css+\"'>\"+newvalue+\"</div>\"+commented; \n\t\t\t\treturn newvalue+commented;\n\t\t\t}\n\t\t}\n\t}\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\treturn value+commented;\n}\n\nexport function reset(view){\n\tvar grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tvar columns = view.config.columnCount;\n\tvar rows = view.config.rowCount;\n\n\tvar cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate(el) {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i <= columns; i++) {\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader: {\n\t\t\t\ttext: nms.encode[i],\n\t\t\t\tcss: view._hideColumn && view._hideColumn.indexOf(i+1) >= 0 ? \"webix_ssheet_hide_column\" : \"\"\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\n\tgrid.refreshColumns(cols);\n\n\tif(view._hideColumn && view._hideColumn.length)\n\t\tview._hideColumn.map(id => grid.hideColumn(id));\n\n\n\tvar data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n\n\tif(view._hideRow && view._hideRow.length) {\n\t\tgrid.filter(function(obj){\n\t\t\tif(view._hideRow.indexOf(obj.id) === -1) {\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tif(obj.id - 1 === 0){\n\t\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\t\t\tview.$$(\"cells\").refreshColumns();\n\t\t\t\t}else {\n\t\t\t\t\tview.$$(\"cells\").addCellCss(obj.id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nfunction _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}\n\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function LINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import * as methods from \"./math/methods\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{ view:\"label\", label:\"Edit: \", width:60},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\", \n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\tstartEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(cell){\n\t\tstartEdit(this, cell, false);\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(view._table, cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tif(name == \"lock\" || name == \"filter\" || name == \"dropdown\")\n\t\t\tdisableEditor(options.row,  options.column);\n\t});\n\n\tfunction startEdit(table, cell, clear){\n\t\tvar editor = table.getColumnConfig(cell.column).editor;\n\t\t//do not interfere with custom editors\n\t\tif (editor == \"text\"){\n\t\t\tfillEditor(table, cell, clear);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tif (view.getCellEditor(row, column) || view.isCellLocked(row,column)){\n\t\t\teditor.setValue(\"\");\n\t\t\teditor.disable();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction fillEditor(table, cell, clear){\n\t\tif(disableEditor(cell.row, cell.column))\n\t\t\treturn;\n\t\teditor.enable();\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : view.getCellValue(cell.row, cell.column) );\n\t\teditor.focus();\n\n\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(table, st, en, a); };\n\t}\n\n\tfunction pasteRange(view, st, en, cell){\n\t\tif (st == en){\n\t\t\tif (!editor.expectOperator()) return endEdit(cell);\n\t\t\teditor.setRange(st);\n\t\t\twebix.delay(() => editor.focus());\n\t\t}\n\t\telse{\n\t\t\tif (!editor.expectRange()) return endEdit(cell);\n\t\t\teditor.setRange(`${st}:${en}`);\n\t\t\twebix.delay(() => editor.focus());\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n}\n\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, rows, cols){\n\t//var [ row, column, value, style] = obj.data[i];\n\tfor (var i=0; i<data.length; i++){\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"],\n\t\t\tcallback:(res) => {\n\t\t\t\tif (res)\n\t\t\t\t\tremove(view, view._activeSheet);\n\t\t\t}\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t}\n\t\t\t\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\twebix.UIManager.setFocus(this.view);\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\": showPreview\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.cell;\n\tvar image = fillUrl(dialog.$dialog.getBody().elements.url.getValue());\n\tdialog.view.addImage(cell.row, cell.column, image);\n\tdialog.close();\n}\n\nfunction showPreview(image){\n\tif (image){\n\t\timage = webix.template.escape(fillUrl(image));\n\t\tthis.getFormView().elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t}\n}\n\nfunction fillUrl(url){\n\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\turl = \"http://\" + url;\n\treturn url;\n}","function isChar(char){\n\tvar code = char.charCodeAt(0);\n\treturn (code>=65 && code<=122) || code === 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\t\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key === \"!\"){\n\t\t\t\t//mulit-sheet math\n\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\ti=j+1;\n\t\t\t} else if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\t\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\t\n}\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tif (key === \"'\" || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (sheet === \"\") {\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && isPosition(word)){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\tvalue = [sheet, word];\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] === \":\"){\n\t\t\t\t\t\t\t//for multi-sheet reference, ignore second parameter of range\n\t\t\t\t\t\t\tlet [, end] = getWord(formula, next+2, \"\");\n\t\t\t\t\t\t\tnext = end - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\t\n\tif (formula[0] !== \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t} else if (!quotes && (key === \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\tif (formula[i+1] === \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t} else if (isPosition(word)){\n\t\t\t\tif (formula[i+1] === \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else \n\t\t\t\t\t\tcode += operandCode(deps, word, sheet);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\")\n\t\t\t\t\tcontinue; \n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tvar cache = passive ? passives : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(){\n\tactives = {};\n\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tvar stack = split(formula);\n\tvar max = stack.length;\n\tvar start = area ? area.start : null;\n\tvar end = area ? area.end : null;\n\tfor (var i = 1; i < max; i+=2) {\n\t\tvar [row, column, flags] = stack[i];\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif ((action.id === \"move\") && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t} else if (action.id === \"row\" && action.start <= row){\n\t\t\trow += isRowFix ? 0 : action.count;\n\t\t} else if (action.id === \"column\" && action.start <= column){\n\t\t\tcolumn += isColumnFix ? 0 : action.count;\n\t\t}\n\n\t\tif (!column || !row)\n\t\t\tstack[i] = 0;\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\n\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\":\n\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(value[2].options, name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCache = { };\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\t//actuve sheet accessor\n\tif (!name) \n\t\treturn SheetAccessor(activeAccessor(view));\n\n\t//passive sheet accessor\n\tif (!view._mathSheetCache[name]){\n\t\tlet temp = view._mathSheetCache[name] = (name === getActive(view)) ? \n\t\t\tSheetAccessor(activeAccessor(view)) :\n\t\t\tSheetAccessor(passiveAccessor(view, name));\n\t\ttemp.init();\n\n\t}\n\n\treturn view._mathSheetCache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test)) return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tvar set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (var i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test)?(val?val:\"\"):test;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst page = getSheet(view, name).content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tvar value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\n\nexport function nullFilter(){ \n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn \"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\";\n}\n\nexport function rangeValue(view, text, extra){\n\tvar vals;\n\tif (typeof text == \"string\"){\n\t\tvar pos = range(text, view);\n\t\tvar page = getAccessor(view, pos[4]);\n\t\tvals = page.getRange.apply(page, pos);\n\t} else {\n\t\tvals = webix.copy(text);\n\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tlet t = {};\n\t\t\tfor (var i=vals.length-1; i>=0; i--){\n\t\t\t\tif (t[vals[i]])\n\t\t\t\t\tvals.splice(i,1);\n\t\t\t\telse\n\t\t\t\t\tt[vals[i]] = true;\n\t\t\t}\n\t\t}\n\t\tif (extra.order) vals.sort();\n\n\t\tvar empty = vals.indexOf(\"\");\n\t\tif (empty > -1){\n\t\t\tvals.splice(empty,1);\n\t\t\tif (extra.filter)\n\t\t\t\tvals.unshift(nullFilter());\n\t\t}\n\n\t\tif (extra.empty) vals.unshift({id: \"$empty\", $empty: true, value: \"\"});\n\t}\n\n\treturn vals;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\n\tadd(name, text){\n\t\tlet needUpdate = !!this._ranges[name];\n\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tif (needUpdate)\n\t\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet)\n\t\t\treturn getAccessor(this._master, sheet).getRangeCode(name);\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}","import {Dialog} from \"./common\";\nimport {rangeValue} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nvar types = [\n\t{id:\"line\", value:\"Line\"},\n\t{id:\"spline\", value:\"Spline\"},\n\t{id:\"splineArea\", value:\"Spline Area\"},\n\t{id:\"area\", value:\"Area\"},\n\t{id:\"bar\", value:\"Bar\"},\n\t{id:\"pie\", value:\"Pie\"}\n];\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id: \"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:webix.i18n.spreadsheet.labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:types\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValue(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tvar data = form.getValues();\n\n\t\tvar sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id)){\t\t\t\t\n\t\t\t\tthis.view.ranges.remove(table.getItem(data.id).name);\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\t} else\n\t\t\t\tthis.$dialog.$$(\"table\").add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"],\n\t\t\tcallback:(res) => {\n\t\t\t\tif (res){\n\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\t\t\ttable.remove(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:40 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:40 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: locale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{ view:\"list\", id:\"list\", css:\"webix_ssheet_format_type\", width:120, scroll:false, data:this.getFormats(), select:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tif(id[0] === \"custom\")\n\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"custom\");\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\tif(id[0] === \"percent\")\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"form\", id:\"form\", margin:15, height:270, paddingY:0, paddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{ template: function(obj){\n\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t}, css: \"webix_ssheet_format_preview\", autoheight: true, id: \"preview\", borderless:true},\n\t\t\t\t\t\t\t{ view:\"counter\", css:\"webix_ssheet_counter\", label:locale[\"decimal-places\"], name:\"zeros\", value:0, batch:\"common\" },\n\t\t\t\t\t\t\t{ view:\"checkbox\", label:locale[\"separator\"], name: \"separator\", batch:\"common\" },\n\t\t\t\t\t\t\t{ view:\"formlist\", label:locale[\"negative\"], name:\"negative\", batch:\"common\", css:\"webix_ssheet_format_negative\",\n\t\t\t\t\t\t\t\ttemplate: (obj)=>{\n\t\t\t\t\t\t\t\t\tif(this.list){\n\t\t\t\t\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\t\t\t\t\tlet style = {css:\"\"};\n\t\t\t\t\t\t\t\t\t\tlet value = format(-1234.56789, style);\n\n\t\t\t\t\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[{id:1}, {id:2}, {id:3}]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view:\"text\", label: locale[\"format-pattern\"], name:\"format\", labelPosition:\"top\", batch:\"custom\",\n\t\t\t\t\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\" },\n\t\t\t\t\t\t\t{ template: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+locale[\"format-docs\"]+\"</a>\",\n\t\t\t\t\t\t\t\tborderless:true, batch:\"custom\", id: \"docs\"}\n\t\t\t\t\t\t],\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 155\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.$$(\"bar\").setValues({format:name}, true);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type !== \"custom\"){\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tif(!name || name == -1)\n\t\t\ttype = name = \"price\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tvalues.format = fmt.getFormatSource(name);\n\t\tif(type !==\"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tlet value = this.view.$$(\"cells\").getItem(this.cell[0].row)[this.cell[0].column];\n\t\tif(value === \"\" || isNaN(value))\n\t\t\tvalue = 1234.56789;\n\t\tthis.value = value;\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\n\t\tconst format = this.getFormat();\n\t\tlet style = {css:\"\"};\n\t\tlet value = fmt.format2code(format.fmt, format.delimiters)(this.value*1, style);\n\t\t\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\t\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._safeInt(values.value, 10));\n\t\t\t} else {\n\t\t\t\titem.push([this._safeInt(values.value, 10),this._safeInt(values.value2, 10)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view,\n\t\t\tselect = view.getSelectedId(true),\n\t\t\tcell = select[0];\n\n\t\tif(!select.length) return false;\n\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = item[1][0].toString();\n\t\t\t\t\tvalues.value2 = item[1][1].toString();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = item[1].toString();\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tif(!this.view.getSelectedId())\n\t\t\treturn false;\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t{ width: 25 }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\t\t\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-number\"],\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 500,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tborderless: true,\n\t\t\t\trows: [\n\t\t\t\t\t{rows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tvar view = this.view;\n\t\tvar sheets = view._sheets;\n\t\tvar value = {};\n\n\t\tif(sheets && sheets.length > 1){\n\t\t\tfor(var i = 0; i<sheets.length; i++)\n\t\t\t\tvalue[sheets[i].name] = (view._activeSheet === sheets[i].name?1:0);\n\t\t}\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tvar values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=LINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=LINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:520, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:35},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.showTemplate(this.textarea.getValue());\n\t\t\t\t\t\t\t\tthis.changeTextarea();\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t\tthis.$dialog.hide();\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.type = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\t\tthis.size = this.$dialog.getBody().elements[\"size\"];\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.type == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.size.define({ value: value, label: webix.i18n.spreadsheet.labels[this.type == \"row\" ? \"height\" : \"width\"]});\n\t\tthis.size.refresh();\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.getValue()*1;\n\t\tif(this.type == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\t\tthis.close();\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tname: \"size\",\n\t\t\t\tview: \"text\"\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as aiw from \"./image\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nvar bases = [ aiw, asw, rgs, dpd, fmt, cnd, exp, lnk, pnt, cmt, siz ];\nvar dialogs = {};\n\nexport function init(view){\n\tif(view.config.readonly)\n\t\tbases = [cmt];\n\tfor (var i = 0; i < bases.length; i++)\n\t\tdialogs[bases[i].action] = new bases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tvar box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif(!group || !(prevData && group == prevData.group))\n\t\t\t\tview.refresh();\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span)\n\t\t\tspan[3] = style?style.id:\"\";\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetLockCss(view, options.row, options.column, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif(!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction setLockCss(view, row, column, mode){\n\tvar span = getSpan(view, row, column);\n\tif(span){\n\t\tif(mode){\n\t\t\tif(span[3].indexOf(lockCss) == -1)\n\t\t\t\tspan[3] += \" \"+lockCss;\n\t\t}\n\t\telse\n\t\t\tspan[3] = span[3].replace(\" \"+lockCss,\"\");\n\t\tview._table.refresh();\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {updateMath}  from \"../math/updater\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\")\n\t\t\tloadChangedData(view,value);\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import \t\t{methods} \t\tfrom \"./methods\";\nimport * as rgs \t\t\tfrom \"./ranges\";\nimport * as psh \t\t\tfrom \"./placeholder\";\nimport \t\t{changeRange} \tfrom \"../helpers/column_names\";\nimport * as sheets \t\t\tfrom \"./sheet\";\nimport \t\t{_parse} \t\tfrom \"./cache\";\n\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", recalckCell);\n\tview.attachEvent(\"onMathRefresh\", recalckAll);\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _dataParse(view, data));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\t\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\n\t\tgrid.refresh();\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value && value.toString().indexOf(\"=\") === 0){\n\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\tvar row = view.getRow(r);\n\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\tif (formula.triggers.length){\n\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t}\n\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\t\t\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction _dataParse(view, obj){\n\tview.ranges.parse(obj.ranges);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import {rangeValue} from \"../math/ranges\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\treset(view);\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { unique: true, empty:true, order:true, filter: ed.useAsFilter });\n\t\t\t\t\telse if(webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { empty:true, filter: ed.useAsFilter });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\ttable.attachEvent(\"onAfterEditStop\", function(state, id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup;\n\t\tdelete col.$popup;\n\n\t\tif (isFilter(view, id.row, id.column))\n\t\t\treturn view.filterSpreadSheet();\n\t});\n\n\ttable.on_click.ss_filter = function(e, id){\n\t\tthis.edit(id);\n\t};\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n\tview._table._ssFilters = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor(row in tblEditors){\n\t\tfor(column in tblEditors[row]){\n\t\t\tif(!isFilter(view, row, column))\n\t\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t\t}\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\teditors = data.editors;\n\n\tif(editors)\n\t\tfor(i = 0; i < editors.length; i++)\n\t\t\tview.setCellEditor.apply(view,editors[i]);\n}\n\n\n\n\nexport function clearEditors(view, range){\n\tvar refilter = false;\n\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tlet filter = view._table._ssFilters[cell.row];\n\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t}\n\t\t}\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\tdelete filter[cell.column];\n\t\t\t\trefilter = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\n\n\nexport function isFilter(view, row, column){\n\tvar filters = view._table._ssFilters;\n\treturn filters[row] && filters[row][column];\n}\n\nexport function addCellFilter(view, row, column, initial){\n\tvar filters = view._table._ssFilters;\n\tvar line = filters[row] = filters[row] || {};\n\tline[column] = [row,column];\n\n\tview.callEvent(\"onAction\", [\"addFilter\", { row, column }]);\n\tif(!initial && view.getCellValue(row,column) != \"\")\n\t\tview.setCellValue(row,column,\"\");\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\teditors = data.editors;\n\n\tif(inc){\n\t\t// create new editors\n\t\tfor(i = editors.length-1;i >=0;i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\t//make copy of editor object\n\t\t\t\teditor = editors[i][2] = webix.copy(editor);\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted, translate, updateFilters){\n\tvar editor = extra.dropdown.editor;\n\tif(extra.dropdown.filter){\n\t\tif(updateFilters){\n\t\t\tvar  options = changeRange(editor.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\t\t\toptions = changeRange(options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\t\t\tview.setCellFilter(row, col, options);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:col, value:null, newValue:{options:options} }]);\n\t\t}\n\t}\n\telse {\n\t\tview.setCellEditor(row, col, editor);\n\t\tif(cutted === 1)\n\t\t\tview.setCellEditor(extra.row, extra.col, {});\n\t}\n}\n\nexport function setFilter(view, row, column, range, initial){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\tview.setCellEditor(row,column, { editor:\"richselect\", options: range, useAsFilter:true });\n\taddCellFilter(view, row, column, initial);\n}\n\nfunction getFilterRange(view,  row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1,column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {isFilter, pasteDropdown} from \"../operations/dropdown\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilter();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\n\tvar newValue = cdata;\n\tvar style = null;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tstyle = cdata.style;\n\t\tview.setStyle(row, col, style);\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate, updateFilters);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col)};\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = { editor:editor, filter: !!isFilter(view, id, col) };\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","export function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(obj){\n\t\tvar item = this.getItem(obj);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tvar key = columns[i];\n\t\t\tvar value = item[key];\n\t\t\tvar css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math)\n\t\t\t\tvalue = item[\"$\"+key] || value;\n\n\t\t\t//put not empty values in serialization\n\t\t\tvar hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tdata.push([obj*1, key*1, (hasValue ? value : \"\"), css]);\n\t\t\t}\n\t\t}\n\t}, true);\n\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, style] = obj.data[i];\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\t\tif (style){\n\t\t\titem.$cellCss = item.$cellCss || {};\n\t\t\titem.$cellCss[column] = style;\n\t\t}\n\t\tview.callEvent(\"onCellChange\", [row, column, value]);\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}\n","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tvar sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tvar type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tvar obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id)?id: [id, id];\n}\n\nexport function setColumnState(view, column, state){\n\t// hide\n\tif(!column){\n\t\tlet sel = view.getSelectedId(true),\n\t\t\taction = {id:state === false?\"show\":\"hide\", group:\"column\"};\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse{\n\t\tlet ids = getIds(column);\n\t\tif(!view._hidden_cols_hash[ids[0]] && (webix.isUndefined(state)||state)){\n\t\t\t_hideColumn({id: \"hide\", group: \"column\"}, {column:ids[0]}, {column:ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if(view._hidden_cols_hash[ids[0]] && (webix.isUndefined(state)|| !state)){\n\t\t\tvar inc = ids[0]>1?1:-1;\n\t\t\t_showColumn({id: \"show\", group: \"column\"},  {column:ids[0]+inc},  {column:ids[1]+inc}, view);\n\t\t}\n\t}\n\n}\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setRowState(view, row, state){\n\t// hide\n\tif(!row){\n\t\tlet sel = view.getSelectedId(true),\n\t\t\taction = {id:state === false?\"show\":\"hide\", group:\"row\"};\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tlet ids = getIds(row);\n\t\tif (!view._hidden_rows_hash[ids[0]] && (webix.isUndefined(state) || state)) {\n\t\t\t_hideRow({id: \"hide\", group: \"row\"}, {row: ids[0]}, {row: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (view._hidden_rows_hash[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tvar inc = ids[0] > 1 ? 1 : -1;\n\t\t\t_showRow({id: \"show\", group: \"row\"}, {row: ids[0] + inc}, {row: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tvar hrows  = []; var hcols = [];\n\tfor(var r in view._hidden_rows_hash) hrows.push(r);\n\tfor(var c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tvar hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(var r = 0; r<hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(var c = 0; c<hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tview.$$(\"cells\").unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = view.$$(\"cells\").getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\n\t\tview.$$(\"cells\").hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t} else {\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split >= start.row)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tvar s = start[name], e = s + inc; \n\t\tif(s>e) [s, e] = [e, s];\n\n\t\tfor(var i = s; i<e; i++){\n\t\t\tfor(var h = 0; h<data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}\n\n","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, config.width).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {changeRange} from \"../helpers/column_names\";\nimport {setFilter} from \"./dropdown\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\tfilter(view);\n\t});\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"filter\"){\n\t\t\tif (!value)\n\t\t\t\tview.removeFilter();\n\t\t\telse\n\t\t\t\tview.setCellFilter(row, column, value.options);\n\t\t} else if (type == \"dropdown\"){\n\t\t\tview.setCellEditor(row, column, value);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\n\nexport function getFilters(table){\n\tvar filters = table._ssFilters;\n\tvar all = [];\n\tfor (var row in filters)\n\t\tfor (var column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tlet filters = getFilters(view._table);\n\tlet editors = view._table._ssEditors;\n\t\n\tlet result = data.filters = [];\n\tfor (var i = 0; i<filters.length; i++){\n\t\tlet [row, column] = filters[i];\n\t\tlet options = editors[row][column].options;\n\t\tif(options)\n\t\t\tresult.push([row,column,options]);\n\t}\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tfilters = data.filters;\n\n\tif(filters){\n\t\tfor(i = 0; i < filters.length; i++)\n\t\t\tsetFilter(view, filters[i][0],filters[i][1], filters[i][2], true);\n\t\t\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction filter(view, range){\n\trange = range || view._table.getSelectArea();\n\n\tgroup.set(function(){\n\t\tview.removeFilter();\n\t\tif (!range) return;\n\t\tlet row = range.start.row;\n\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\tview.setCellFilter(row, i, range);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:i, value:null, newValue:range }]);\n\t\t}\n\t});\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tfilters = data.filters;\n\n\tif(inc){\n\t\tfor(i = filters.length-1;i >=0;i--){\n\t\t\tlet [row,column,range] = filters[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tfilters[i][0] = name == \"row\"?row*1 + inc:row;\n\t\t\t\tfilters[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t\tfilters[i][2] = changeRange(range, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./formats\";\nimport * as m7  from \"./hide_row_col\";\nimport * as m8  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6, m7, m8];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tview._loading_data = true;\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t\tview._loading_data = false;\n\t});\n}","var types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tvar uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\twebix.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tview.showSheet(options.sheets[i]);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\t\tdata = data.concat(webix.toExcel(view._table, options));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:options.sheets[i]+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(options.styles)\n\t\t\tdata[i].styles = _getStyles(view, options);\n\t}\n\tview.showSheet(active);\n\t\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\t\t\tif (css)\n\t\t\t\tresult[rIndex][cIndex - options.xCorrection] = cached[css.id] = cached[css.id] || _getCellStyle(css.text);\n\t\t\telse\n\t\t\t\tresult[rIndex][cIndex - options.xCorrection] = defaults;\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\t\t\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\t\t\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\t\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\tobj = _getStyles(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\t\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n\treturn obj;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++)\n\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setColumnState(this, column, state);\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setRowState(this, row, state);\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors)\n\t\tclearEditors(this, rangeStr);\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\titem[column] = value;\n\t\t\tdelete item[\"$\"+column];\n\n\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\tthis.saveCell(row, column);\n\t\t}\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","import {nullFilter} from \"../math/ranges\";\nimport  * as drd from \"../operations/dropdown\";\nimport {getFilters} from \"../operations/filter\";\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellFilter(row, column, range){\n\tdrd.setFilter(this, row, column, range);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tlet line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tlet value = line[column]|| this._table.getItem(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor)\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\telse{\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null; \n}\n\nexport function addFilter(row,column){\n\treturn drd.addCellFilter(this,row,column);\n}\n\nexport function removeFilter(){\n\tvar fs = getFilters(this._table);\n\tfor\t(let i=0; i<fs.length; i++){\n\t\tlet [row,column] = fs[i];\n\t\tlet value = this.getCellEditor(row, column);\n\t\tthis.setCellEditor(row,column, null);\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis.callEvent(\"onAction\", [\"filter\", {row, column, value, newValue:null }]);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter(function(){ return true; });\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){ \n\t\tvar filters = getFilters(this._table);\n\t\tfor (var i=0; i<filters.length; i++){\n\t\t\tlet [row,column] = filters[i];\n\t\t\tvar value = this._table.getItem(row)[column];\n\n\t\t\tvar all = false;\n\t\t\tconst isNull = (value == nullFilter());\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (!value) return true;\n\t\t\t\tif (isNull && !obj[column]) return true;\n\t\t\t\tif (obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") all = true;\n\t\t\t\treturn all || obj[column] == value;\n\t\t\t}, 1, i);\n\t\t}\n\t}, this);\n\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\twebix.modalbox({\n\t\ttype: \"alert webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tbuttons:[webix.i18n.spreadsheet.labels.cancel,webix.i18n.spreadsheet.labels.ok],\n\t\tcallback:(result) => {\n\t\t\tconfig.callback.call(this,result!=\"0\");\n\t\t}\n\t});\n}\n\nexport function alert(config){\n\twebix.modalbox({\n\t\ttype: \"alert webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tbuttons:[webix.i18n.spreadsheet.labels.ok]\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"add-image\"},\n\t\t{id: \"add-sparkline\"},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{\n\t\tid: \"view\", submenu:[\n\t\t\t{id: \"columns\", submenu: [\n\t\t\t\t{id: \"insert-column\"},\n\t\t\t\t{id: \"delete-column\"},\n\t\t\t\t{id: \"show-column\"},\n\t\t\t\t{id: \"hide-column\"},\n\t\t\t\t{id: \"resize-column\"}\n\t\t\t]},\n\t\t\t{id: \"rows\", submenu: [\n\t\t\t\t{id: \"insert-row\"},\n\t\t\t\t{id: \"delete-row\"},\n\t\t\t\t{id: \"show-row\"},\n\t\t\t\t{id: \"hide-row\"},\n\t\t\t\t{id: \"resize-row\"}\n\t\t\t]},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"freeze-columns\"},\n\t\t\t{id: \"freeze-rows\"},\n\t\t\t{id: \"hide-gridlines\"},\n\t\t\t{id: \"hide-headers\"}\n\t\t]\n\t}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tvar obj = this.config;\n\t\tvar rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\t\t\n\t\t//data part\n\t\tlet tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\trows.push(tbl.init(this, tblObj));\n\n\t\tvar bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsizeToContent:true,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tview.ui(context);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m16a,m3,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29];\n\tfor (var i = 0; i < all.length; i++)\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["getPopupConfig","options","view","css","autowidth","template","obj","text","icon","value","webix","i18n","spreadsheet","menus","id","data","on","onItemClick","button","this","config","master","$$","getTopParentView","params","getItem","area","getSelectArea","concat","start","end","callEvent","labels","tooltips","table","protoUI","name","$cssName","$init","body","tooltip","xCount","yCount","ui","richselect","defaults","width","margin","cols","scroll","select","onAfterSelect","getParentView","updateMasterValue","rows","title","onChange","hide","getValue","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","join","palette","colorboard","borderless","height","onSelect","setMasterValue","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","toString","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","apply","arguments","buttons","getHeaderConfig","label","paddingX","paddingY","click","getBodyConfig","content","elements","getFormElements","cancel","save","body_setter","_typeof","window","head_setter","padding","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","trg","getInputNode","cursor","selectionStart","val","charAt","str1","substring","str2","search","length","toLowerCase","indexOf","attachEvent","node","tagName","sizes","html","offset","y","x","show","_this","refresh","setValueHere","$enterKey","isVisible","keyPressTimeout","suggestData","code","Date","_last_value_set","updateCellValue","delay","_table","moveSelection","once","ev","env","isIE8","event","paintValue","endEdit","e","which","keyCode","dir","cell","activeCell","getItemNode","innerHTML","newv","getCellValue","row","column","setCellValue","$setValueHere","formula","setSelectionRange","expectRange","trim","substr","expectOperator","last","setRange","range","focus","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","arrow","elementsConfig","labelWidth","_initOnChange","blockEvent","$eventSource","i","count","_count","$all","_findNext","unblockEvent","keys","base","labelRight","baseHeight","skin","$active","inputHeight","getValues","output","form","onSelectChange","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","_loading_data","getActiveSheet","clearTimeout","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","charCodeAt","col","nind","sheet","parts","split","ranges","getCode","d1","d2","notAlphaNum","escapeSheet","test","toRange","x2","y2","rangeObj","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","align","rowHeight","border_checks","mode","_style_handlers","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","key","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","copy","$cellFormat","format","setStyle","_setStyle","setRangeStyle","getTextSize","appendChild","Math","max","scrollWidth","scrollHeight","removeChild","old","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","formats","formatsCount","formatSources","formatCache","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatHelpers","setDefaultFormats","price","getFormat","extra","priceFormat","values","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","round","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parceFormat","getFormatName","format2code","addFormat","nev","delimiters","splitFormat","conditional","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","inserted","betweenPlaceholders","placeholder","decimal","getParts","left","right","reverse","lzeros","lfills","rzeros","rfills","rmax","changeAreaDecimals","cells","getCells","r","c","firstValue","firstStyle","rules","isNumber","changeCellDecimals","setValues","updateDecimals","parced","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","isCustom","formValues","toExcel","leftText","leftPlaceholders","rightText","fmtParts","sepFmtParts","getFmtPartValues","fmtPart","firstPlaceholder","index","Infinity","k","load","actions","span","isMerged","j","c0","getSpan","splitCell","confirm","res","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","locale","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","toolbar","allElements","elm","isUndefined","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","_selectRange","selectAll","order","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","min","b","addSelectArea","adjustColumn","eachRow","rowobj","$height","setColumnWidth","adjustRow","eachColumn","getColumnConfig","setRowHeight","highlightColRow","header","sr","er","sc","ec","addCellCss","removeCellCss","getHeaderNode","addCss","removeCss","dragStartColumn","grid","showHandler","document","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","target","eventRemove","math","editMath","st","ed","undefined","addEventListener","parentNode","cellIndex","dragEndColumn","cop","getEditor","isCellLocked","editor","finalStep","ids","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","activeElement","UIManager","getFocus","need_focus","setFocus","setDefaultCss","$name","spans","leftSplit","areaselect","editable","editaction","liveEditor","minColumnWidth","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","commented","helper","parsed","parseFloat","isNaN","newvalue","clearAll","columnCount","rowCount","el","nms","_hideColumn","refreshColumns","map","hideColumn","parse","_hideRow","isMac","addHotKey","readonly","sel","$anyKey","edit","del","styleHotKey","v","ctrlU","preventEvent","ctrlP","attr","elementOn","state","_to_number","_combine","arr","SUM","sum","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","toFixed","ROUNDDOWN","floor","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","IMAGE","escape","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","LINK","IF","pos","neg","methods","strings","other","methodsName","startEdit","clear","fillEditor","disableEditor","getCellEditor","disable","enable","$handleSelection","en","pasteRange","isEnabled","disabled","find","func","findIndex","actionMap","remove","_activeSheet","add","prepare","selectSheet","showItem","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","getScrollState","tabWidth","context","dataOrder","_sheets","splice","rename","defaultBottom","hidden","editValue","onClick","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","callAction","getMark","disableItem","enableItem","showSheet","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","forEach","getActive","getDimension","_resetTable","Dialog","$dialog","$hide","$show","close","unescape","DialogBox","box","preview","parseImage","server","images","position","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","dialog","image","fillUrl","addImage","onHideClick","onCancelClick","file","reader","FileReader","onload","_this2","getFormView","readAsDataURL","response","imageURL","isChar","char","getWord","passive","quotes","operand","isPosition","word","flags","chars","namedRangeCode","deps","sheetInd","rangeCode","t","crosssheet","lines","ph","next","pushLine","actives","passives","core","struct","pair","pairsheet","rawword","triggers","parser","_build_function","error_function","updateMath","action","stack","isRowFix","isColumnFix","cut","updateSheetNames","oldName","thisSheet","multiSheet","helpers","_mathSheetCache","param","getAccessor","clearMathCache","_mathSheetCore","_mathSheetHelpers","SheetAccessor","activeAccessor","passiveAccessor","page","formulas","getRangeCode","getCell","execute","getRange","getRangeValue","nullFilter","rangeValue","vals","unique","sort","empty","unshift","$empty","Ranges","_master","_ranges","needUpdate","types","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","typesChangeHandler","sparkConfig","checkRange","addSparkline","alert","getSelectedRange","getRanges","toSheetRange","validate","exists","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","setCellEditor","fillForm","getFormats","updateForm","closeWin","forms","_safeInt","value2","collection","conditions","_getCondition","activeValue","_setCondition","_clean","display","onFocus","current_view","_this3","clearRow","getRows","getConditionStyle","conditionStyle","_this4","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","queryView","minWidth","minHeight","relative","resize","onViewResize","animate","showInput","addComment","onBlur","showTemplate","changeTextarea","comment","open","getHead","columnWidth","define","bases","aiw","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","dialogs","lockCss","lockCell","_mapCellsCalls","_locks","newValue","cm","lock","updatePosition","locked","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreUndo","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","addSpan","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","pull","isUndo","undoSpan","setLockCss","checkSpanBorders","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","update","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","active","rs","vs","m","solvedMath","solvedCounter","backtrak","applyMath","tkey","check_trigger","srow","scolumn","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","recalckAll","getState","_dataParse","addEmptyCollection","_empty","_pull","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","first","second","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","_ssFilters","clearEditors","refilter","filterSpreadSheet","isFilter","filters","addCellFilter","initial","pasteDropdown","updateFilters","dropdown","setCellFilter","setFilter","getFilterRange","useAsFilter","styledata","clipdata","$popup","on_click","ss_filter","editors","tblEditors","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","getElementsByClassName","Object","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","removeFilter","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","getIds","setColumnState","_showColumn","isColumnVisible","setRowState","_showRow","isRowVisible","showColumn","unselect","_updatePosition","h","hrows","hcols","_adjustRowHeight","wrap","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","removeSelectArea","sorters","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","element","shift","newMath","gridlines","getFilters","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","m8","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","bottom","top","$exportView","rawValues","ignore","export_mode","_exportExcel","dataOnly","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","safe","_parseExcel","driver","full","names","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","drd","addFilter","fs","isNull","modalbox","ok","resetUndo","groupUndo","setFormat","changeDecimals","defaultMenu","submenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","sizeToContent","submenuConfig","onBeforeShow","onMenuItemClick","getMenuItem","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m16a","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;0jEAgDA,SAASA,EAAeC,SAChB,CACNC,KAAM,iBACNC,IAAK,uBACLC,WAAU,EACVC,SAAU,SAASC,OACdC,EAAO,UACRD,EAAIE,OACND,GAAQ,+DAAiED,EAAIE,KAAO,cACrFD,GAAQD,EAAIG,OAASC,MAAMC,KAAKC,YAAYC,MAAMP,EAAIQ,KAAOR,EAAIQ,IAGlEC,KAAMd,EACNe,GAAG,CACFC,YAAa,SAASH,OACjBI,EAASC,KAAKC,OAAOC,UACtBH,EAAO,KACLhB,EAAOQ,MAAMY,GAAGJ,GAAQK,mBACxBC,EAAS,CAACL,KAAKM,QAAQX,OACxBJ,MAAMY,GAAGJ,GAAQE,OAAOM,KAAK,KAC3BA,EAAOxB,EAAKoB,GAAG,SAASK,gBACzBD,IACFF,EAASA,EAAOI,OAAO,CAACF,EAAKG,MAAMH,EAAKI,OAE1C5B,EAAK6B,UAAU,YAAYP,OCvEhCd,MAAMC,KAAKC,YCDI,CACdoB,OAAO,QAEI,kBACE,kBACF,iBACC,0BACM,0BACA,2BACL,2BACD,gCACG,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,4BACA,8BACC,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,cACA,gBAEG;MACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,UAEVC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cAC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"}